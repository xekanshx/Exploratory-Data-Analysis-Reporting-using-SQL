/*
********************************************************************************
Key Measures Review (Business Metrics)
********************************************************************************
Objective:
    - Compute high-level aggregate measures for performance analysis.
    - Provide a snapshot of business activity and volume.

SQL Operations Applied:
    - COUNT
    - SUM
    - AVG
********************************************************************************
*/

-- Calculate overall revenue
SELECT 
    SUM(sales_amount) AS overall_sales
FROM gold.fact_sales;

-- Calculate total units sold
SELECT 
    SUM(quantity) AS units_sold
FROM gold.fact_sales;

-- Calculate mean selling price
SELECT 
    AVG(price) AS average_price
FROM gold.fact_sales;

-- Calculate number of orders (with and without distinct)
SELECT 
    COUNT(order_number) AS order_count
FROM gold.fact_sales;

SELECT 
    COUNT(DISTINCT order_number) AS unique_order_count
FROM gold.fact_sales;

-- Count number of available products
SELECT 
    COUNT(product_name) AS product_count
FROM gold.dim_products;

-- Count total registered customers
SELECT 
    COUNT(customer_key) AS customer_count
FROM gold.dim_customers;

-- Count customers who have placed at least one order
SELECT 
    COUNT(DISTINCT customer_key) AS active_customer_count
FROM gold.fact_sales;

-- Consolidated business metrics report
SELECT 
    'Total Sales' AS metric_name,
    SUM(sales_amount) AS metric_value
FROM gold.fact_sales
UNION ALL
SELECT 
    'Total Quantity',
    SUM(quantity)
FROM gold.fact_sales
UNION ALL
SELECT 
    'Average Price',
    AVG(price)
FROM gold.fact_sales
UNION ALL
SELECT 
    'Total Orders',
    COUNT(DISTINCT order_number)
FROM gold.fact_sales
UNION ALL
SELECT 
    'Total Products',
    COUNT(DISTINCT product_name)
FROM gold.dim_products
UNION ALL
SELECT 
    'Total Customers',
    COUNT(customer_key)
FROM gold.dim_customers;
